(function(){"use strict";var n={enter:13,esc:27,left:37,right:39};angular.module("thatisuday.ng-image-gallery",["ngAnimate"]).provider("ngImageGalleryOpts",function(){var n={thumbnails:!0,thumbSize:80,thumbLimit:!1,inline:!1,bubbles:!0,bubbleSize:20,imgBubbles:!1,bgClose:!1,piracy:!1,imgAnim:"fadeup",textValues:{imageLoadErrorMsg:"Error when loading the image!",deleteButtonTitle:"Delete this image...",editButtonTitle:"Edit this image...",closeButtonTitle:"Close",externalLinkButtonTitle:"Open image in new tab..."}};return{setOpts:function(t){angular.extend(n,t)},$get:function(){return n}}}).filter("ngImageGalleryTrust",["$sce",function(n){return function(t,i){return n.trustAs(i||"html",t)}}]).directive("ngRightClick",["$parse",function(){return{restrict:"A",scope:!1,link:function(n,t){t.bind("contextmenu",function(t){if(n.piracy==!1)return t.preventDefault(),n.piracy})}}}]).directive("showImageAsync",[function(){return{restrict:"A",scope:!1,link:function(n,t,i){var r=new Image;r.src=i.showImageAsync;r.onload=function(){n.$apply(function(){i.asyncKind=="thumb"?(t.css({backgroundImage:'url("'+i.showImageAsync+'")'}),t.empty()):i.asyncKind=="bubble"&&t.css({backgroundImage:'url("'+i.showImageAsync+'")'})})};r.onerror=function(){t.empty()}}}}]).directive("bubbleAutoFit",["$window","$timeout",function(n,t){return{restrict:"A",scope:!1,link:{pre:function(i,r){var u=function(){var n=r[0].getBoundingClientRect().width;if(n!=0){var u=i.bubbleSize,f=8,e=u+f,s=n/e,t=Math.floor(s),h=n-t*e,c=h/t,o=f+c,l=o+u;i._bubblesInView=t;i._finalBubbleSpace=l;i._bubbleMargin="0 "+o/2+"px";i._safeApply(angular.noop)}};t(u);angular.element(n).bind("resize",function(){t(u)});i.$watch("inline",function(){t(u)});i.$watch("bubbleSize",function(){t(u)});i.$watchCollection("images",function(){t(u)})}}}}]).directive("bubbleAutoScroll",["$window","$timeout",function(n,t){return{restrict:"A",scope:!1,link:function(i){var r=function(){var n=i._bubblesInView-(i._bubblesInView-i._activeImageIndex);t(function(){if(n>i._bubblesInView-2){var t=i._activeImageIndex+1-i._bubblesInView+1;i._bubblesContainerMarginLeft=i._activeImageIndex!=i.images.length-1?"-"+i._finalBubbleSpace*t+"px":"-"+i._finalBubbleSpace*(t-1)+"px"}else i._bubblesContainerMarginLeft="0px"})};angular.element(n).bind("resize",function(){t(r)});i.$watch("_bubblesInView",function(){t(r)});i.$watch("_activeImageIndex",function(){t(r)});i.$watchCollection("images",function(){t(r)})}}}]).directive("ngImageGallery",["$rootScope","$timeout","$q","ngImageGalleryOpts",function(t,i,r,u){return{replace:!0,transclude:!1,restrict:"AE",scope:{images:"=",methods:"=?",conf:"=?",thumbnails:"=?",thumbSize:"=?",thumbLimit:"=?",inline:"=?",bubbles:"=?",bubbleSize:"=?",imgBubbles:"=?",bgClose:"=?",piracy:"=?",imgAnim:"@?",textValues:"=?",onOpen:"&?",onClose:"&?",onDelete:"&?",onEdit:"&?"},template:'<div class="ng-image-gallery img-move-dir-{{_imgMoveDirection}}" ng-class="{inline:inline}" ng-hide="images.length == 0"><div ng-if="thumbnails && !inline" class="ng-image-gallery-thumbnails"><div class="thumb" ng-repeat="image in images track by image.id" ng-if="thumbLimit ? $index < thumbLimit : true" ng-click="methods.open($index);" show-image-async="{{image.thumbUrl || image.url}}" title="{{image.title}}" async-kind="thumb" ng-style="{\'width\' : thumbSize+\'px\', \'height\' : thumbSize+\'px\'}"><div class="loader"><\/div><\/div><\/div><div class="ng-image-gallery-modal" ng-if="opened" ng-cloak><div class="ng-image-gallery-backdrop" ng-if="!inline"><\/div><div class="ng-image-gallery-content" ng-show="!imgLoading" ng-click="backgroundClose($event);"><div class="actions-icons-container"><div class="delete-img" ng-repeat="image in images track by image.id" ng-if="_activeImg == image && image.deletable" title="{{textValues.deleteButtonTitle}}" ng-click="_deleteImg(image)"><\/div><div class="edit-img" ng-repeat="image in images track by image.id" ng-if="_activeImg == image && image.editable" title="{{textValues.editButtonTitle}}" ng-click="_editImg(image)"><\/div><\/div><div class="control-icons-container"><a class="ext-url" ng-repeat="image in images track by image.id" ng-if="_activeImg == image && image.extUrl" href="{{image.extUrl}}" target="_blank" title="{{textValues.externalLinkButtonTitle}}"><\/a><div class="close" ng-click="methods.close();" ng-if="!inline"  title="{{textValues.closeButtonTitle}}"><\/div><\/div><div class="prev" ng-click="methods.prev();" ng-class="{\'bubbles-on\':bubbles}" ng-hide="images.length == 1"><\/div><div class="next" ng-click="methods.next();" ng-class="{\'bubbles-on\':bubbles}" ng-hide="images.length == 1"><\/div><div class="galleria"><div class="galleria-images img-anim-{{imgAnim}} img-move-dir-{{_imgMoveDirection}}"><img class="galleria-image" ng-right-click ng-repeat="image in images track by image.id" ng-if="_activeImg == image" ng-src="{{image.url}}" ondragstart="return false;" ng-attr-alt="{{image.alt || undefined}}"/><\/div><div class="galleria-title-description-wrapper"><div ng-repeat="image in images track by image.id" ng-if="(image.title || image.desc) && (_activeImg == image)"><div class="title" ng-if="image.title" ng-bind-html="image.title | ngImageGalleryTrust"><\/div><div class="desc" ng-if="image.desc" ng-bind-html="image.desc | ngImageGalleryTrust"><\/div><\/div><\/div><div class="galleria-bubbles-wrapper" ng-if="bubbles && !imgBubbles" ng-hide="images.length == 1" ng-style="{\'height\' : bubbleSize+\'px\'}" bubble-auto-fit><div class="galleria-bubbles" bubble-auto-scroll ng-style="{\'margin-left\': _bubblesContainerMarginLeft}"><span class="galleria-bubble" ng-click="_setActiveImg(image);" ng-repeat="image in images track by image.id" ng-class="{active : (_activeImg == image)}" ng-style="{\'width\' : bubbleSize+\'px\', \'height\' : bubbleSize+\'px\', margin: _bubbleMargin}"><\/span><\/div><\/div><div class="galleria-bubbles-wrapper" ng-if="bubbles && imgBubbles" ng-hide="images.length == 1" ng-style="{\'height\' : bubbleSize+\'px\'}" bubble-auto-fit><div class="galleria-bubbles" bubble-auto-scroll ng-style="{\'margin-left\': _bubblesContainerMarginLeft}"><span class="galleria-bubble img-bubble" ng-click="_setActiveImg(image);" ng-repeat="image in images track by image.id" ng-class="{active : (_activeImg == image)}" show-image-async="{{image.bubbleUrl || image.thumbUrl || image.url}}" async-kind="bubble" ng-style="{\'width\' : bubbleSize+\'px\', \'height\' : bubbleSize+\'px\', \'border-width\' : bubbleSize/10+\'px\', margin: _bubbleMargin}"><\/span><\/div><\/div><\/div><\/div><div class="ng-image-gallery-loader" ng-show="imgLoading"><div class="spinner"><div class="rect1"><\/div><div class="rect2"><\/div><div class="rect3"><\/div><div class="rect4"><\/div><div class="rect5"><\/div><\/div><\/div><div class="ng-image-gallery-errorplaceholder" ng-show="imgError"><div class="ng-image-gallery-error-placeholder" ng-bind-html="textValues.imageLoadErrorMsg | ngImageGalleryTrust"><\/div><\/div><\/div><\/div>',link:{pre:function(f,e){var s,h,o,c;if(f._showLoader=function(){f.imgLoading=!0},f._hideLoader=function(){f.imgLoading=!1},f._loadImg=function(n){var t,i;return n?(t=r.defer(),n.hasOwnProperty("cached")||f._showLoader(),i=new Image,i.src=n.url,i.onload=function(){n.hasOwnProperty("cached")||f._hideLoader();n.hasOwnProperty("cached")||(n.cached=!0);t.resolve(n)},i.onerror=function(){n.hasOwnProperty("cached")||f._hideLoader();t.reject("Error when loading img")},t.promise):r.reject()},f._setActiveImg=function(n){f._imgMoveDirection=f.images.indexOf(f._activeImg)-f.images.indexOf(n)==f.images.length-1||f.images.indexOf(f._activeImg)-f.images.indexOf(n)<=0&&f.images.indexOf(f._activeImg)-f.images.indexOf(n)!=-(f.images.length-1)?"forward":"backward";f._loadImg(n).then(function(n){f._activeImg=n;f._activeImageIndex=f.images.indexOf(n);f.imgError=!1},function(){f._activeImg=null;f._activeImageIndex=f.images.indexOf(n);f.imgError=!0})},f._safeApply=function(n){var t=this.$root.$$phase;t=="$apply"||t=="$digest"?n&&typeof n=="function"&&n():this.$apply(n)},f._deleteImg=function(n){var t=function(){var t=f.images.indexOf(n);console.log(t);f.images.splice(t,1);f._activeImageIndex=0};f.onDelete({img:n,cb:t})},f._editImg=function(n){f.inline||f.methods.close();f.onEdit({img:n})},f.images=f.images!=undefined?f.images:[],f.methods=f.methods!=undefined?f.methods:{},f.conf=f.conf!=undefined?f.conf:{},f.$watchCollection("conf",function(n){f.thumbnails=n.thumbnails!=undefined?n.thumbnails:f.thumbnails!=undefined?f.thumbnails:u.thumbnails;f.thumbSize=n.thumbSize!=undefined?n.thumbSize:f.thumbSize!=undefined?f.thumbSize:u.thumbSize;f.thumbLimit=n.thumbLimit!=undefined?n.thumbLimit:f.thumbLimit!=undefined?f.thumbLimit:u.thumbLimit;f.inline=n.inline!=undefined?n.inline:f.inline!=undefined?f.inline:u.inline;f.bubbles=n.bubbles!=undefined?n.bubbles:f.bubbles!=undefined?f.bubbles:u.bubbles;f.bubbleSize=n.bubbleSize!=undefined?n.bubbleSize:f.bubbleSize!=undefined?f.bubbleSize:u.bubbleSize;f.imgBubbles=n.imgBubbles!=undefined?n.imgBubbles:f.imgBubbles!=undefined?f.imgBubbles:u.imgBubbles;f.bgClose=n.bgClose!=undefined?n.bgClose:f.bgClose!=undefined?f.bgClose:u.bgClose;f.piracy=n.piracy!=undefined?n.piracy:f.piracy!=undefined?f.piracy:u.piracy;f.imgAnim=n.imgAnim!=undefined?n.imgAnim:f.imgAnim!=undefined?f.imgAnim:u.imgAnim;f.textValues=n.textValues!=undefined?n.textValues:f.textValues!=undefined?f.textValues:u.textValues}),f.onOpen=f.onOpen!=undefined?f.onOpen:angular.noop,f.onClose=f.onClose!=undefined?f.onClose:angular.noop,f.onDelete=f.onDelete!=undefined?f.onDelete:angular.noop,f.onEdit=f.onEdit!=undefined?f.onEdit:angular.noop,s=!0,f.$watchCollection("images",function(){s?s=!1:f.images.length&&f._setActiveImg(f.images[f._activeImageIndex||0])}),h=!0,f.$watch("_activeImageIndex",function(n){h?h=!1:f.images.length&&f._setActiveImg(f.images[n])}),f.$watch("inline",function(){i(function(){f.inline&&f.methods.open()})}),f.methods.open=function(n){f._activeImageIndex=n?n:0;f.opened=!0;f.inline||angular.element(document.body).addClass("body-overflow-hidden");i(function(){f.onOpen()},300)},f.methods.close=function(){f.opened=!1;angular.element(document.body).removeClass("body-overflow-hidden");i(function(){f.onClose();f._activeImageIndex=0},300)},f.methods.next=function(){f._activeImageIndex=f._activeImageIndex==f.images.length-1?0:f._activeImageIndex+1},f.methods.prev=function(){f._activeImageIndex==0?f._activeImageIndex=f.images.length-1:f._activeImageIndex--},f.backgroundClose=function(n){var i,t;if(f.bgClose&&!f.inline)for(i=["galleria-image","destroy-icons-container","ext-url","close","next","prev","galleria-bubble"],t=0;t<n.target.classList.length;t++)if(i.indexOf(n.target.classList[t])!=-1)break;else f.methods.close()},angular.element(document).bind("keyup",function(t){f.inline||(t.which==n.right||t.which==n.enter?i(function(){f.methods.next()}):t.which==n.left?i(function(){f.methods.prev()}):t.which==n.esc&&i(function(){f.methods.close()}))}),window.Hammer){o=new Hammer(e[0]);o.on("swiperight",function(){i(function(){f.methods.prev()})});o.on("swipeleft",function(){i(function(){f.methods.next()})});o.on("doubletap",function(){f.inline||i(function(){f.methods.close()})})}c=function(){angular.element(document.body).removeClass("body-overflow-hidden")};t.$on("$stateChangeSuccess",c);t.$on("$routeChangeSuccess",c)}}}}])})();